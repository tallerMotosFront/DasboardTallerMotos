<div class="clientes-container">
  <h2>Gestión de Clientes</h2>
  
  <div class="clientes-grid" *ngIf="!editingCliente || clientes.length === 0">
    <mat-card *ngFor="let cliente of clientes" class="cliente-card">
      <mat-card-header>
        <mat-card-title>{{ cliente.nombre }} {{ cliente.apellido }}</mat-card-title>
      </mat-card-header>
      
      <mat-card-content>
        <div class="cliente-info">
          <div class="info-row">
            <mat-icon>phone</mat-icon>
            <span>{{ cliente.telefono }}</span>
          </div>
          
          <div class="info-row">
            <mat-icon>email</mat-icon>
            <span>{{ cliente.email }}</span>
          </div>
          
          <div class="info-row">
            <mat-icon>home</mat-icon>
            <span>{{ cliente.direccion }}</span>
          </div>
          
          <div class="info-row">
            <mat-icon>calendar_today</mat-icon>
            <span>Registrado: {{ cliente.fechaRegistro | date:'dd/MM/yyyy' }}</span>
          </div>
        </div>
      </mat-card-content>
      
      <mat-card-actions>
        <button 
          mat-raised-button 
          color="primary" 
          (click)="startEdit(cliente)"
          [disabled]="editingCliente !== null">
          <mat-icon>edit</mat-icon>
          Editar
        </button>
      </mat-card-actions>
    </mat-card>
  </div>

  <!-- Formulario de edición -->
  <mat-card *ngIf="editingCliente" class="edit-form-card">
    <mat-card-header>
      <mat-card-title>Editar Cliente: {{ editingCliente.nombre }} {{ editingCliente.apellido }}</mat-card-title>
    </mat-card-header>
    
    <mat-card-content>
      <form [formGroup]="editForm" (ngSubmit)="saveEdit()">
        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Nombre</mat-label>
            <input matInput formControlName="nombre" placeholder="Nombre">
            <mat-error *ngIf="editForm.get('nombre')?.hasError('required')">
              El nombre es obligatorio
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Apellido</mat-label>
            <input matInput formControlName="apellido" placeholder="Apellido">
            <mat-error *ngIf="editForm.get('apellido')?.hasError('required')">
              El apellido es obligatorio
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Teléfono</mat-label>
            <input matInput formControlName="telefono" placeholder="555-1234">
            <mat-icon matPrefix>phone</mat-icon>
            <mat-error *ngIf="editForm.get('telefono')?.hasError('required')">
              El teléfono es obligatorio
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Email</mat-label>
            <input matInput type="email" formControlName="email" placeholder="email@ejemplo.com">
            <mat-icon matPrefix>email</mat-icon>
            <mat-error *ngIf="editForm.get('email')?.hasError('required')">
              El email es obligatorio
            </mat-error>
            <mat-error *ngIf="editForm.get('email')?.hasError('email')">
              El email no es válido
            </mat-error>
          </mat-form-field>
        </div>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Dirección</mat-label>
          <input matInput formControlName="direccion" placeholder="Calle, número, ciudad">
          <mat-icon matPrefix>home</mat-icon>
          <mat-error *ngIf="editForm.get('direccion')?.hasError('required')">
            La dirección es obligatoria
          </mat-error>
        </mat-form-field>

        <div class="form-actions">
          <button mat-button type="button" (click)="cancelEdit()">
            <mat-icon>cancel</mat-icon>
            Cancelar
          </button>
          <button mat-raised-button color="primary" type="submit" [disabled]="editForm.invalid">
            <mat-icon>save</mat-icon>
            Guardar Cambios
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
